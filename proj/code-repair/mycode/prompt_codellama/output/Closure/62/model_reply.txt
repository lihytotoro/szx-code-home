 The correct line at the INFILL location is:

    && 0 <= charno && charno < sourceExcerpt.length()) {